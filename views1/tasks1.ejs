<h1>Tâches (Total: <%= tasks.length %>)</h1>
<ul>
<% tasks.forEach(task => { %>
  <li><%= task.title %> - <% if(task.done){ %> ✅ <% } else { %> ❌ <% } %></li>
<% }) %>
</ul>

<h2>Ajouter une tâche</h2>
<form id="taskForm">
  <input type="text" name="title" placeholder="Titre de la tâche" required>
  <button type="submit">Ajouter</button>
</form>

<a href="/">Retour à l'accueil</a>

<script>
const form = document.getElementById('taskForm');
form.addEventListener('submit', async (e) => {
  e.preventDefault();
  const title = form.title.value;
  const res = await fetch('/api/tasks', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ title })
  });
  if(res.ok){
    location.reload(); // recharge pour afficher la nouvelle tâche
  } else {
    const data = await res.json();
    alert(data.error);
  }
});
</script>
